
-----------------------------
Mon Jun  7 19:52:40 +08 2021
-----------------------------
CHAPTER 1 : INITIAL SETUP

1.1.1.2: Ensure mounting of vFAT filesystems is limited
Fail:,vFAT is not configured properly
1.1.6 Ensure separate partition exists for /var 
Pass:,/var is configured properly
1.1.7 Ensure separate partition exists for /var/tmp
Fail:,Seperation partition does not exist
1.1.11 Ensure separate partition exists for /var/log 
Fail:,Seperate partion does not exist for /var/log
1.1.12 Ensure separate partition exists for /var/log/audit 
Fail:,Seperate partition does not exist for /var/log/audit
1.1.13 Ensure separate partition exists for /home 
Pass:,/home is configured properly
END OF CHAPTER 1

CHAPTER 1 : NETWORK CONFIGURATION

3.3 Uncommon Network Protocols
3.3.1 Ensure DCCP is disabled
Fail:,DCCP is not disabled
                
3.3.2 Ensure SCTP is disabled
Fail:,SCTP is not disabled
                
3.3.3 Ensure RDS is disabled
Fail:,RDS is not disabled
                
3.3.4 Ensure TIPC is disabled
Fail:,TIPC is not disabled
                
3.6 Disable IPv6
Fail:,IPv6 is not disabled
                

CHAPTER 4 LOGGING AND AUDITING

4.1.1 Ensure auditing is enabled
4.1.1.1 Ensure auditd is installed
Pass:,auditd is installed
4.1.1.2 Ensure auditd service is enabled
Pass:,auditd service is enabled
4.1.1.3 Ensure auditing for processees that start prior to auditd is enabled
Pass:,auditing for processes that start prior to auditd is enabled
4.1.1.4 Ensure audit_backlog_limit is sufficient
Pass:,audit_backlog_limit is sufficient

4.1.2 Configure Data Retention
4.1.2.1 Ensure aduit log storage size is configured
Important check:,Check if max_log_file parameter in /etc/audit/auditd.conf in accordance with site policy
4.1.2.2 Ensure audit logs are not automatically deleted
Fail:,Audit logs are automatically deleted
4.1.2.3 Ensure system is disabled when audit logs are full
Fail:,System is not disabled when audit logs are full
4.1.3 Ensure changes to system administration scope(sudoers) is collected
Fail:,Changes to sudoers are not collected
4.1.4 Ensure login and logout events are collected
Fail:,Login and logout events are not collected
4.1.5 Ensure session initiation information is collected
Fail:,Session initiation information is not collected
4.1.6 Ensure events that modify date and time iformation are collected
Fail:,Events that modify data dn time information are not collected
4.1.7 Ensure events that modify Mandatory Access Controls are collected
Pass:,Events that modify system Mandatory Access Controls are collected
4.1.8 Ensure events that modify the system network environment are collected
Fail:,Events that modify the system network environment are not collected
4.1.9 Ensure discretionary access control permission modification events are collected
Fail:,Permission modification events are not collected
4.1.10 Ensure unsuccessful unauthorized file access attempts are collected
Fail:,unsuccessful unauthorised file access attempts are not collected
4.1.11 Ensure events that modify user/group information are collected
Fail:,events that modify user/group info are not collected
4.1.12 Ensure successful file system mounts are collected
Fail:,successful file system mouns are not collected
4.1.14 Ensure file detection events by users are collected
Fail:,File deletion events by users are not collected
4.1.15 Ensure kernel module loading and unloading is collected
Fail:,insmod, rmmod and modprobe are not set
4.1.17 Ensure the audit configuration is immutable
Pass:,Audit configuration is immutable
6.1.1 Audit system permissions
Fail:,bash-4.1.2-29.el6.x86_64 is installed 

NUMBER OF PASSES: 8
NUMBER OF FAILED: 23

-----------------------------
Mon Jun  7 20:12:32 +08 2021
-----------------------------
LEVEL 1 SERVER AUDIT

CHAPTER 1 : INITAL SETUP

1.1.1.1: Ensure mounting of cramfs filesystems is disabled
Fail:,Cramfs is not disabled
1.1.1.3: Ensure mounting of squashfs filesystems is disabled
Fail:,squashfs filesystems is not disabled
1.1.1.4 Ensure mounting of udf filesystems is disabled
Fail:,udf filesystems are not disabled
1.1.2 Ensure /tmp is configured
Fail:,/tmp is not configured properly
1.1.3 Ensure nodev option set on /tmp partition
Pass:,/tmp is configured properly
1.1.4 Ensure nosuid option set on /tmp partition
Pass:,/tmp is configured properly
1.1.5 Ensure noexec option set on /tmp partition 
\ePass:,/tmp is configured properly\e
1.1.8 Ensure nodev option set on /var/tmp partition
Pass:,/var/tmp is configured properly
1.1.9 Ensure nosuid option set on /var/tmp partition 
\ePass:,/var/tmp is configured properly\e
1.1.10 Ensure noexec option set on /var/tmp partition 
Pass:,/var/tmp is configured properly
1.1.14 Ensure nodev option set on /home partition
Fail:,/home is not configured properly
1.1.15 Ensure nodev option set on /dev/shm partition
Pass:,1.1.15 is configured properly
1.1.16 Ensure nosuid option set on /dev/shm partition
Pass:,/dev/shm is configured properly
1.1.17 Ensure noexec option set on /dev/shm partition
Fail:,/dev/shm is not configured properly
1.1.21 Ensure sticky bit is set on all world-writable directories
Fail:,Sticky bit is not set on all world-writable diectories
1.1.22 Disable Automounting 
Pass:,Automounting is configured properly
1.1.23 Disable USB Storage 
Fail:,USB Storage is not disabled
1.2.1 Ensure GPG keys are configured
CHECK:,Verify GPG keys are configured correctly for your packet manager
gpg-pubkey-8483c65d-5ccc5b19 --> gpg(CentOS (CentOS Official Signing Key) <security@centos.org>)
1.2.2 Ensure gpgcheck is globally activated
Pass:,gpgcheck is configured correctly
1.2.3 Ensure package manager repositories are configured
CHECK:,Verify that repositories are configured correctly
repo id                         repo name
appstream                       CentOS Linux 8 - AppStream
baseos                          CentOS Linux 8 - BaseOS
extras                          CentOS Linux 8 - Extras
1.3.1 Ensure sudo is installed
Pass:,sudo is installed
1.3.2 Ensure sudo commands use pty
Fail:,sudo commands are not configured properly
1.3.3 Ensure sudo log file exists
Fail:,sudo log file does not exist
END OF CHAPTER 1

CHAPTER 2 : SERVICES
2.1 inetd Services

2.1.1 Ensure xinetd is not installed
Pass:,xinetd is not installed

2.2 Time Synchronisation

2.2.1.1 Ensure time synchronisation is in use
Pass:,chrony is installed
2.2.2 Ensure X Window System is not installed
Fail:,X Window System is installed (GUI)
2.2.3 Ensure rsyncd server is not enabled
Pass:,rsyncd is not enabled
2.2.4 Ensure avahi-daemon server is not enabled
Fail:,avahi-daemon is enabled
2.2.5 Ensure snmpd server is not enabled
Pass:,snmpd is not enabled
2.2.6 Ensure squid server is not enabled
Pass:,squid is not enabled
2.2.7 Ensure smb server is not enabled
Pass:,smb is not enabled
2.2.8 Ensure dovecot server is not enabled
Pass:,dovecot is not enabled
2.2.9 Ensure httpd server is not enabled
Pass:,httpd is not enabled
2.2.10 Ensure vsftpd server is not enabled
Pass:,vsftpd is not enabled
2.2.11 Ensure named server is not enabled
Pass:,named is not enabled
2.2.12 Ensure nfs server is not enabled
Pass:,nfs is not enabled
2.2.13 Ensure rpcbind server is not enabled
Fail:,rpcbind is enabled
2.2.14 Ensure slapd server is not enabled
Pass:,slapd is not enabled
2.2.15 Ensure dhcpd server is not enabled
Pass:,dhcpd is not enabled
2.2.16 Ensure cups server is not enabled
Fail:,cups is enabled
2.2.17 Ensure ypserv server is not enabled
Pass:,ypserv is not enabled
2.2.18 Ensure mail transfer agent is configured for local-only mode
Pass:,MTA is not listening on any non-loopback address(127.0.0.1 or ::1)

2.3 Service Clients

2.3.1 Ensure NIS Client is not installed
Pass:,'ypbind' is not installed
2.3.2 Ensure telnet client is not installed
Fail:,telnet is installed
2.3.3 Ensure LDAP client is not installed
Pass:,'openldap-clients' is not installed

CHAPTER 3: NETWORK CONFIGURATION

3.1 Network Parameters Host Only
3.1.1 Ensure IP forwarding is disabled
Fail:,IP forwarding is not disabled
                
3.1.2 Ensure packet redirect sending is disabled
Fail:,Packet redirect sending is not disabled
                
3.2 Network Parameters Host and Router
3.2.1 Ensure source routed packets are not accepted
Fail:,Source routed packets are accepted
                
3.2.2 Ensure ICMP redirects are not accepted
Fail:,ICMP redirects are accepted
                
3.2.3 Ensure secure ICMP redirects are not accepted
Fail:,Secure ICMP redirects are accepted
                
3.2.4 Ensure suspicious packets are logged
Fail:,Suspicious packets are not logged
                
3.2.5 Ensure broadcast ICMP requests are ignored
Pass:,Broadcast ICMP requests are ignored
                
3.2.6 Ensure bogus ICMP responses are ignored
Pass:,Bogus ICMP responses are ignored
                
3.2.7 Ensure Reverse Path Filtering is enabled
Fail:,Reverse Path Filtering is not enabled
                
3.2.8 Ensure TCP SYN Cookies is enabled
Pass:,TCP SYN Cookies is enabled
                
3.2.9 Ensure IPv6 router advertisements are not accepted
Fail:,IPv6 router advertisements are accepted
                
3.4 Firewall Configuration
3.4.1 Ensure Firewall Software is installed
3.4.1.1 Ensure a Firewall package is installed
Pass:,A firewall package is installed
                
3.4.2 Configure firewalld
3.4.2.1 Ensure firewalld service is enabled and running
Pass:,firewalld service is enabled and running
                
3.4.2.2 Ensure nftables is not enabled
Pass:,nftables is not enabled
                
3.4.2.3 Ensure default zone is set
Pass:,Default zone is set
                
3.4.2.4 Ensure network interfaces are assigned to appropriate zone
incomplete 3.4.2.4
3.4.2.5 Ensure unnecessary services and ports are not accepted
incomplete 3.4.2.5
3.4.2.6 Ensure iptables is not enabled
Fail:,iptables is enabled
                
3.4.3 Configure nftables
3.4.3.1 Ensure iptables are flushed
Pass:,iptables are flushed
                
3.4.3.2 Ensure a table exists
Pass:,A table exists
                
3.4.3.3 Ensure base chains exist
Fail:,base chains do not exists
                
3.4.3.4 Ensure loopback traffic is configured
Fail:,loopback traffic is not configured
                
3.4.3.5 Ensure outbound and established connections are configured
Fail:,outbound and established connections are not configured
                
3.4.3.6 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.3.7 Ensure nftables service is eabled
Fail:,nftables service is not enabled
                
3.4.3.8 Ensure nftables rules are permanent
3.4.3.8 Unsure how to do
3.4.4 Configure iptables
3.4.4.1 Configure IPv4 iptables
3.4.4.1.1 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.4.1.2 Ensure loopback traffic is configured
3.4.4.1.2 Unsure how to do
3.4.4.1.3 Ensure outbound and established connections are configured
3.4.4.1.3 Unsure how to do
3.4.4.1.4 Ensure firewall rule exists for all open ports
3.4.4.1.4 Unsure how to do
3.4.4.2 Configure IPv6 ip6tables
3.4.4.2.1 Ensure IPv6 default deny firewall policy
3.4.4.2.1 Unsure how to do
3.4.4.2.2 Ensure IPv6 loopback traffic is configured
3.4.4.2.2 Unsure how to do
3.4.4.2.3 Ensure IPv6 outbound and established connections are not configured
3.4.4.2.3 Unsure how to do
3.4.4.2.4 Ensure IPv6 firewall rules exist for all open ports
3.4.4.2 Unsure how to do
3.5 Ensure wireless interfaces are disabled
3.5 Unsure how to do

CHAPTER 4 : LOGGING AND AUDITING

4.2 Configure logging

4.2.1 COnfigure rsyslog

4.2.1.1 Ensure rsyslog is installed
Pass:,rsyslog is installed
4.2.1.2 Ensure rsyslog Service is installed
Pass:,rsyslog Service is installed
4.2.1.3 Ensure rsyslog default file permissions configured
Fail:,$FileCreateMode is not 0640 or more restrictive
4.2.1.4 Ensure logging is configured
Pass:,logging is configured (Check /etc/rsyslog.conf and /etc/rsyslog.d/*.conf and edit the lines as appropriate for your environment)
4.2.1.5 Ensure rsyslog is configured to send logs to a remote log host
Fail:,rysyslog is not configured to send logs to a remote log host

4.2.2 Configure Journald

4.2.2.1 Ensure journald is configured to send logs to rsyslog
Fail:,journald does not forward logs to syslog
4.2.2.2 Ensure journald is configured to compress large log files
Pass:,journald is set to compress large files
4.2.2.3 Ensure journald is configured to write logfiles to persistent disk
Fail:,logs are not persisted to disk
4.2.3 Ensure permissions on all logfiles are configured
Fail:,Other has permissions on some files and Group has write or execute permissions on some files

CHAPTER 6 : System Maintenance
6.1.2 Ensure permissions on /etc/passwd are configured
Pass:,Permisions are set ,(PAGE 421)
6.1.3 Ensure permissions on /etc/shadow are configured
Fail:,Permisions are not set
6.1.4 Ensure permissions on /etc/group are configured
Pass:,Permisions are set ,(PAGE 423)
6.1.5 Ensure permissions on /etc/gshadow are configured
Fail:,Permisions are not set
6.1.6 Ensure permissions on /etc/passwd- are configured
Fail:,Permisions are not set
6.1.7 Ensure permissions on /etc/shadow- are configured
Fail:,Permisions are not set
6.1.8 Ensure permissions on /etc/group- are configured
Fail:,Permisions are not set
6.1.9 Ensure permissions on /etc/gshadow- are configured
Fail:,Permisions are not set
6.1.10 Ensure no world writable files exist
Pass:,No world writable files exist ,(PAGE 430)
6.1.11 Ensure no unowned files or directories exist
Pass:,No unowned files or directories exist ,(PAGE 432)
6.1.12 Ensure no ungrouped files or directories exist
Pass:,No ungrouped files or directories exist ,(PAGE 434)
6.1.13 Audit SUID executables
Output listed:
/usr/bin/vmware-user-suid-wrapper
/usr/bin/mount
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/su
/usr/bin/crontab
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/umount
/usr/bin/at
/usr/bin/fusermount
/usr/lib/polkit-1/polkit-agent-helper-1
/usr/sbin/mount.nfs
/usr/sbin/pam_timestamp_check
/usr/sbin/unix_chkpwd
/usr/sbin/userhelper
/usr/sbin/grub2-set-bootflag
/usr/libexec/dbus-1/dbus-daemon-launch-helper
/usr/libexec/sssd/krb5_child
/usr/libexec/sssd/selinux_child
/usr/libexec/sssd/ldap_child
/usr/libexec/sssd/proxy_child
/usr/libexec/cockpit-session
/usr/libexec/spice-gtk-x86_64/spice-client-glib-usb-acl-helper
/usr/libexec/Xorg.wrap
/usr/libexec/qemu-bridge-helper
6.1.14 Audit SGID executables
Output listed:
/usr/bin/locate
/usr/bin/write
/usr/sbin/lockdev
/usr/libexec/utempter/utempter
/usr/libexec/openssh/ssh-keysign
6.2.1 Ensure password fields are not empty
Pass:,password feilds are not empty ,(PAGE 441)
6.2.2 Ensure no legacy + entries exist in /etc/passwd
Pass:,no legacy + entries exist in /etc/passwd ,(PAGE 442)
6.2.3 Ensure root PATH Integrity
Fail:,Cant ensure root PATH Integrity ,(PAGE 443)
6.2.4 Ensure no legacy + entries exist in /etc/shadow
Pass:,no legacy + entries exist in /etc/shadow ,(PAGE 444)
6.2.5 Ensure no legacy + entries exist in /etc/group
Pass:,no legacy + entries exist in /etc/group ,(PAGE 445)
6.2.6 Ensure root is the only UID 0 account
Pass:,root is the only UID 0 account ,(PAGE 446)
6.2.7 Ensure users home directories permissions are 750 or more restrictive
Pass:,users home directories permissions are 750 or more restrictive
6.2.8 Ensure users own their home directories
Fail:,users do not own their home directories ,(PAGE 449)
6.2.9 Ensure users dot files are not group or world writable
Pass:,users dot files are not group or world writable
6.2.10 Ensure no users have .forward files
Pass:,no users have .forward files
6.2.11 Ensure no users have .netrc files
Pass:,No users have .netrc files
6.2.12 Ensure users .netrc Files are not group or world accessible
Pass:,users .netrc Files are not group or world accessible
6.2.13 Ensure no users have .rhosts files
Pass:,no users have .rhosts files
6.2.14 Ensure all groups in /etc/passwd exist in /etc/group
Pass:,all groups in /etc/passwd exist in /etc/group
6.2.15 Ensure no duplicate UIDs exist
Pass:,no duplicate UIDs exist
6.2.16 Ensure no duplicate GIDs exist
Pass:,no duplicate GIDs exist
6.2.17 Ensure no duplicate user names exist
Pass:,no duplicate user names exist
6.2.18 Ensure no duplicate group names exist
Pass:,no duplicate group names exist
6.2.19 Ensure shadow group is empty
Pass:,shadow group is empty
6.2.20 Ensure all users home directories exist
Pass:,all users home directories exist

NUMBER OF PASSES:,64
NUMBER OF FAILED:,43

-----------------------------
Mon Jun  7 20:15:30 +08 2021
-----------------------------
LEVEL 1 SERVER AUDIT

CHAPTER 1 : INITAL SETUP

1.1.1.1: Ensure mounting of cramfs filesystems is disabled
Fail:,Cramfs is not disabled
1.1.1.3: Ensure mounting of squashfs filesystems is disabled
Fail:,squashfs filesystems is not disabled
1.1.1.4 Ensure mounting of udf filesystems is disabled
Fail:,udf filesystems are not disabled
1.1.2 Ensure /tmp is configured
Fail:,/tmp is not configured properly
1.1.3 Ensure nodev option set on /tmp partition
Pass:,/tmp is configured properly
1.1.4 Ensure nosuid option set on /tmp partition
Pass:,/tmp is configured properly
1.1.5 Ensure noexec option set on /tmp partition 
\ePass:,/tmp is configured properly\e
1.1.8 Ensure nodev option set on /var/tmp partition
Pass:,/var/tmp is configured properly
1.1.9 Ensure nosuid option set on /var/tmp partition 
\ePass:,/var/tmp is configured properly\e
1.1.10 Ensure noexec option set on /var/tmp partition 
Pass:,/var/tmp is configured properly
1.1.14 Ensure nodev option set on /home partition
Fail:,/home is not configured properly
1.1.15 Ensure nodev option set on /dev/shm partition
Pass:,1.1.15 is configured properly
1.1.16 Ensure nosuid option set on /dev/shm partition
Pass:,/dev/shm is configured properly
1.1.17 Ensure noexec option set on /dev/shm partition
Fail:,/dev/shm is not configured properly
1.1.21 Ensure sticky bit is set on all world-writable directories
Fail:,Sticky bit is not set on all world-writable diectories
1.1.22 Disable Automounting 
Pass:,Automounting is configured properly
1.1.23 Disable USB Storage 
Fail:,USB Storage is not disabled
1.2.1 Ensure GPG keys are configured
CHECK:,Verify GPG keys are configured correctly for your packet manager
gpg-pubkey-8483c65d-5ccc5b19 --> gpg(CentOS (CentOS Official Signing Key) <security@centos.org>)
1.2.2 Ensure gpgcheck is globally activated
Pass:,gpgcheck is configured correctly
1.2.3 Ensure package manager repositories are configured
CHECK:,Verify that repositories are configured correctly
repo id                         repo name
appstream                       CentOS Linux 8 - AppStream
baseos                          CentOS Linux 8 - BaseOS
extras                          CentOS Linux 8 - Extras
1.3.1 Ensure sudo is installed
Pass:,sudo is installed
1.3.2 Ensure sudo commands use pty
Fail:,sudo commands are not configured properly
1.3.3 Ensure sudo log file exists
Fail:,sudo log file does not exist
END OF CHAPTER 1

CHAPTER 2 : SERVICES
2.1 inetd Services

2.1.1 Ensure xinetd is not installed
Pass:,xinetd is not installed

2.2 Time Synchronisation

2.2.1.1 Ensure time synchronisation is in use
Pass:,chrony is installed
2.2.2 Ensure X Window System is not installed
Fail:,X Window System is installed (GUI)
2.2.3 Ensure rsyncd server is not enabled
Pass:,rsyncd is not enabled
2.2.4 Ensure avahi-daemon server is not enabled
Fail:,avahi-daemon is enabled
2.2.5 Ensure snmpd server is not enabled
Pass:,snmpd is not enabled
2.2.6 Ensure squid server is not enabled
Pass:,squid is not enabled
2.2.7 Ensure smb server is not enabled
Pass:,smb is not enabled
2.2.8 Ensure dovecot server is not enabled
Pass:,dovecot is not enabled
2.2.9 Ensure httpd server is not enabled
Pass:,httpd is not enabled
2.2.10 Ensure vsftpd server is not enabled
Pass:,vsftpd is not enabled
2.2.11 Ensure named server is not enabled
Pass:,named is not enabled
2.2.12 Ensure nfs server is not enabled
Pass:,nfs is not enabled
2.2.13 Ensure rpcbind server is not enabled
Fail:,rpcbind is enabled
2.2.14 Ensure slapd server is not enabled
Pass:,slapd is not enabled
2.2.15 Ensure dhcpd server is not enabled
Pass:,dhcpd is not enabled
2.2.16 Ensure cups server is not enabled
Fail:,cups is enabled
2.2.17 Ensure ypserv server is not enabled
Pass:,ypserv is not enabled
2.2.18 Ensure mail transfer agent is configured for local-only mode
Pass:,MTA is not listening on any non-loopback address(127.0.0.1 or ::1)

2.3 Service Clients

2.3.1 Ensure NIS Client is not installed
Pass:,'ypbind' is not installed
2.3.2 Ensure telnet client is not installed
Fail:,telnet is installed
2.3.3 Ensure LDAP client is not installed
Pass:,'openldap-clients' is not installed

CHAPTER 3: NETWORK CONFIGURATION

3.1 Network Parameters Host Only
3.1.1 Ensure IP forwarding is disabled
Fail:,IP forwarding is not disabled
                
3.1.2 Ensure packet redirect sending is disabled
Fail:,Packet redirect sending is not disabled
                
3.2 Network Parameters Host and Router
3.2.1 Ensure source routed packets are not accepted
Fail:,Source routed packets are accepted
                
3.2.2 Ensure ICMP redirects are not accepted
Fail:,ICMP redirects are accepted
                
3.2.3 Ensure secure ICMP redirects are not accepted
Fail:,Secure ICMP redirects are accepted
                
3.2.4 Ensure suspicious packets are logged
Fail:,Suspicious packets are not logged
                
3.2.5 Ensure broadcast ICMP requests are ignored
Pass:,Broadcast ICMP requests are ignored
                
3.2.6 Ensure bogus ICMP responses are ignored
Pass:,Bogus ICMP responses are ignored
                
3.2.7 Ensure Reverse Path Filtering is enabled
Fail:,Reverse Path Filtering is not enabled
                
3.2.8 Ensure TCP SYN Cookies is enabled
Pass:,TCP SYN Cookies is enabled
                
3.2.9 Ensure IPv6 router advertisements are not accepted
Fail:,IPv6 router advertisements are accepted
                
3.4 Firewall Configuration
3.4.1 Ensure Firewall Software is installed
3.4.1.1 Ensure a Firewall package is installed
Pass:,A firewall package is installed
                
3.4.2 Configure firewalld
3.4.2.1 Ensure firewalld service is enabled and running
Pass:,firewalld service is enabled and running
                
3.4.2.2 Ensure nftables is not enabled
Pass:,nftables is not enabled
                
3.4.2.3 Ensure default zone is set
Pass:,Default zone is set
                
3.4.2.4 Ensure network interfaces are assigned to appropriate zone
incomplete 3.4.2.4
3.4.2.5 Ensure unnecessary services and ports are not accepted
incomplete 3.4.2.5
3.4.2.6 Ensure iptables is not enabled
Fail:,iptables is enabled
                
3.4.3 Configure nftables
3.4.3.1 Ensure iptables are flushed
Pass:,iptables are flushed
                
3.4.3.2 Ensure a table exists
Pass:,A table exists
                
3.4.3.3 Ensure base chains exist
Fail:,base chains do not exists
                
3.4.3.4 Ensure loopback traffic is configured
Fail:,loopback traffic is not configured
                
3.4.3.5 Ensure outbound and established connections are configured
Fail:,outbound and established connections are not configured
                
3.4.3.6 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.3.7 Ensure nftables service is eabled
Fail:,nftables service is not enabled
                
3.4.3.8 Ensure nftables rules are permanent
3.4.3.8 Unsure how to do
3.4.4 Configure iptables
3.4.4.1 Configure IPv4 iptables
3.4.4.1.1 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.4.1.2 Ensure loopback traffic is configured
3.4.4.1.2 Unsure how to do
3.4.4.1.3 Ensure outbound and established connections are configured
3.4.4.1.3 Unsure how to do
3.4.4.1.4 Ensure firewall rule exists for all open ports
3.4.4.1.4 Unsure how to do
3.4.4.2 Configure IPv6 ip6tables
3.4.4.2.1 Ensure IPv6 default deny firewall policy
3.4.4.2.1 Unsure how to do
3.4.4.2.2 Ensure IPv6 loopback traffic is configured
3.4.4.2.2 Unsure how to do
3.4.4.2.3 Ensure IPv6 outbound and established connections are not configured
3.4.4.2.3 Unsure how to do
3.4.4.2.4 Ensure IPv6 firewall rules exist for all open ports
3.4.4.2 Unsure how to do
3.5 Ensure wireless interfaces are disabled
3.5 Unsure how to do

CHAPTER 4 : LOGGING AND AUDITING

4.2 Configure logging

4.2.1 COnfigure rsyslog

4.2.1.1 Ensure rsyslog is installed
Pass:,rsyslog is installed
4.2.1.2 Ensure rsyslog Service is installed
Pass:,rsyslog Service is installed
4.2.1.3 Ensure rsyslog default file permissions configured
Fail:,$FileCreateMode is not 0640 or more restrictive
4.2.1.4 Ensure logging is configured
Pass:,logging is configured (Check /etc/rsyslog.conf and /etc/rsyslog.d/*.conf and edit the lines as appropriate for your environment)
4.2.1.5 Ensure rsyslog is configured to send logs to a remote log host
Fail:,rysyslog is not configured to send logs to a remote log host

4.2.2 Configure Journald

4.2.2.1 Ensure journald is configured to send logs to rsyslog
Fail:,journald does not forward logs to syslog
4.2.2.2 Ensure journald is configured to compress large log files
Pass:,journald is set to compress large files
4.2.2.3 Ensure journald is configured to write logfiles to persistent disk
Fail:,logs are not persisted to disk
4.2.3 Ensure permissions on all logfiles are configured
Fail:,Other has permissions on some files and Group has write or execute permissions on some files

CHAPTER 6 : System Maintenance
6.1.2 Ensure permissions on /etc/passwd are configured
Pass:,Permisions are set ,(PAGE 421)
6.1.3 Ensure permissions on /etc/shadow are configured
Fail:,Permisions are not set
6.1.4 Ensure permissions on /etc/group are configured
Pass:,Permisions are set ,(PAGE 423)
6.1.5 Ensure permissions on /etc/gshadow are configured
Fail:,Permisions are not set
6.1.6 Ensure permissions on /etc/passwd- are configured
Fail:,Permisions are not set
6.1.7 Ensure permissions on /etc/shadow- are configured
Fail:,Permisions are not set
6.1.8 Ensure permissions on /etc/group- are configured
Fail:,Permisions are not set
6.1.9 Ensure permissions on /etc/gshadow- are configured
Fail:,Permisions are not set
6.1.10 Ensure no world writable files exist
Pass:,No world writable files exist ,(PAGE 430)
6.1.11 Ensure no unowned files or directories exist
Pass:,No unowned files or directories exist ,(PAGE 432)
6.1.12 Ensure no ungrouped files or directories exist
Pass:,No ungrouped files or directories exist ,(PAGE 434)
6.1.13 Audit SUID executables
Output listed:
/usr/bin/vmware-user-suid-wrapper
/usr/bin/mount
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/su
/usr/bin/crontab
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/umount
/usr/bin/at
/usr/bin/fusermount
/usr/lib/polkit-1/polkit-agent-helper-1
/usr/sbin/mount.nfs
/usr/sbin/pam_timestamp_check
/usr/sbin/unix_chkpwd
/usr/sbin/userhelper
/usr/sbin/grub2-set-bootflag
/usr/libexec/dbus-1/dbus-daemon-launch-helper
/usr/libexec/sssd/krb5_child
/usr/libexec/sssd/selinux_child
/usr/libexec/sssd/ldap_child
/usr/libexec/sssd/proxy_child
/usr/libexec/cockpit-session
/usr/libexec/spice-gtk-x86_64/spice-client-glib-usb-acl-helper
/usr/libexec/Xorg.wrap
/usr/libexec/qemu-bridge-helper
6.1.14 Audit SGID executables
Output listed:
/usr/bin/locate
/usr/bin/write
/usr/sbin/lockdev
/usr/libexec/utempter/utempter
/usr/libexec/openssh/ssh-keysign
6.2.1 Ensure password fields are not empty
Pass:,password feilds are not empty ,(PAGE 441)
6.2.2 Ensure no legacy + entries exist in /etc/passwd
Pass:,no legacy + entries exist in /etc/passwd ,(PAGE 442)
6.2.3 Ensure root PATH Integrity
Fail:,Cant ensure root PATH Integrity ,(PAGE 443)
6.2.4 Ensure no legacy + entries exist in /etc/shadow
Pass:,no legacy + entries exist in /etc/shadow ,(PAGE 444)
6.2.5 Ensure no legacy + entries exist in /etc/group
Pass:,no legacy + entries exist in /etc/group ,(PAGE 445)
6.2.6 Ensure root is the only UID 0 account
Pass:,root is the only UID 0 account ,(PAGE 446)
6.2.7 Ensure users home directories permissions are 750 or more restrictive
Pass:,users home directories permissions are 750 or more restrictive
6.2.8 Ensure users own their home directories
Fail:,users do not own their home directories ,(PAGE 449)
6.2.9 Ensure users dot files are not group or world writable
Pass:,users dot files are not group or world writable
6.2.10 Ensure no users have .forward files
Pass:,no users have .forward files
6.2.11 Ensure no users have .netrc files
Pass:,No users have .netrc files
6.2.12 Ensure users .netrc Files are not group or world accessible
Pass:,users .netrc Files are not group or world accessible
6.2.13 Ensure no users have .rhosts files
Pass:,no users have .rhosts files
6.2.14 Ensure all groups in /etc/passwd exist in /etc/group
Pass:,all groups in /etc/passwd exist in /etc/group
6.2.15 Ensure no duplicate UIDs exist
Pass:,no duplicate UIDs exist
6.2.16 Ensure no duplicate GIDs exist
Pass:,no duplicate GIDs exist
6.2.17 Ensure no duplicate user names exist
Pass:,no duplicate user names exist
6.2.18 Ensure no duplicate group names exist
Pass:,no duplicate group names exist
6.2.19 Ensure shadow group is empty
Pass:,shadow group is empty
6.2.20 Ensure all users home directories exist
Pass:,all users home directories exist

NUMBER OF PASSES:,64
NUMBER OF FAILED:,43

-----------------------------
Mon Jun  7 20:25:16 +08 2021
-----------------------------
LEVEL 2 SERVER AUDIT

CHAPTER 1 : INITIAL SETUP

1.1.1.2: Ensure mounting of vFAT filesystems is limited
Fail:,vFAT is not configured properly
1.1.6 Ensure separate partition exists for /var 
Pass:,/var is configured properly
1.1.7 Ensure separate partition exists for /var/tmp
Fail:,Seperation partition does not exist
1.1.11 Ensure separate partition exists for /var/log 
Fail:,Seperate partion does not exist for /var/log
1.1.12 Ensure separate partition exists for /var/log/audit 
Fail:,Seperate partition does not exist for /var/log/audit
1.1.13 Ensure separate partition exists for /home 
Pass:,/home is configured properly
END OF CHAPTER 1

CHAPTER 1 : NETWORK CONFIGURATION

3.3 Uncommon Network Protocols
3.3.1 Ensure DCCP is disabled
Fail:,DCCP is not disabled
                
3.3.2 Ensure SCTP is disabled
Fail:,SCTP is not disabled
                
3.3.3 Ensure RDS is disabled
Fail:,RDS is not disabled
                
3.3.4 Ensure TIPC is disabled
Fail:,TIPC is not disabled
                
3.6 Disable IPv6
Fail:,IPv6 is not disabled
                

CHAPTER 4 LOGGING AND AUDITING

4.1.1 Ensure auditing is enabled
4.1.1.1 Ensure auditd is installed
Pass:,auditd is installed
4.1.1.2 Ensure auditd service is enabled
Fail:,auditd service is not enabled
4.1.1.3 Ensure auditing for processees that start prior to auditd is enabled
Pass:,auditing for processes that start prior to auditd is enabled
4.1.1.4 Ensure audit_backlog_limit is sufficient
Pass:,audit_backlog_limit is sufficient

4.1.2 Configure Data Retention
4.1.2.1 Ensure aduit log storage size is configured
Important check:,Check if max_log_file parameter in /etc/audit/auditd.conf in accordance with site policy
4.1.2.2 Ensure audit logs are not automatically deleted
Fail:,Audit logs are automatically deleted
4.1.2.3 Ensure system is disabled when audit logs are full
Fail:,System is not disabled when audit logs are full
4.1.3 Ensure changes to system administration scope(sudoers) is collected
Fail:,Changes to sudoers are not collected
4.1.4 Ensure login and logout events are collected
Fail:,Login and logout events are not collected
4.1.5 Ensure session initiation information is collected
Fail:,Session initiation information is not collected
4.1.6 Ensure events that modify date and time iformation are collected
Fail:,Events that modify data dn time information are not collected
4.1.7 Ensure events that modify Mandatory Access Controls are collected
Pass:,Events that modify system Mandatory Access Controls are collected
4.1.8 Ensure events that modify the system network environment are collected
Fail:,Events that modify the system network environment are not collected
4.1.9 Ensure discretionary access control permission modification events are collected
Fail:,Permission modification events are not collected
4.1.10 Ensure unsuccessful unauthorized file access attempts are collected
Fail:,unsuccessful unauthorised file access attempts are not collected
4.1.11 Ensure events that modify user/group information are collected
Fail:,events that modify user/group info are not collected
4.1.12 Ensure successful file system mounts are collected
Fail:,successful file system mouns are not collected
4.1.14 Ensure file detection events by users are collected
Fail:,File deletion events by users are not collected
4.1.15 Ensure kernel module loading and unloading is collected
Fail:,insmod, rmmod and modprobe are not set
4.1.17 Ensure the audit configuration is immutable
Pass:,Audit configuration is immutable
6.1.1 Audit system permissions
Fail:,bash-4.1.2-29.el6.x86_64 is installed 

NUMBER OF PASSES: 7
NUMBER OF FAILED: 24

-----------------------------
Mon Jun  7 20:33:30 +08 2021
-----------------------------
LEVEL 1 WORKSTATION AUDIT

CHAPTER 1 : INITIAL SETUP

1.1.1.1: Ensure mounting of cramfs filesystems is disabled
Fail:,Cramfs is not disabled
Fail:,squashfs filesystems is not disabled
1.1.1.4 Ensure mounting of udf filesystems is disabled
Fail:,udf filesystems are not disabled
1.1.2 Ensure /tmp is configured
Fail:,/tmp is not configured properly
1.1.3 Ensure nodev option set on /tmp partition
Pass:,/tmp is configured properly
1.1.4 Ensure nosuid option set on /tmp partition
Pass:,/tmp is configured properly
\ePass:,/tmp is configured properly\e
1.1.8 Ensure nodev option set on /var/tmp partition
Pass:,/var/tmp is configured properly
1.1.9 Ensure nosuid option set on /var/tmp partition 
\ePass:,/var/tmp is configured properly\e
1.1.10 Ensure noexec option set on /var/tmp partition 
Pass:,/var/tmp is configured properly
1.1.14 Ensure nodev option set on /home partition
Fail:,/home is not configured properly
1.1.15 Ensure nodev option set on /dev/shm partition
Pass:,1.1.15 is configured properly
1.1.16 Ensure nosuid option set on /dev/shm partition
Pass:,/dev/shm is configured properly
1.1.17 Ensure noexec option set on /dev/shm partition
Fail:,/dev/shm is not configured properly
1.1.21 Ensure sticky bit is set on all world-writable directories
Fail:,Sticky bit is not set on all world-writable diectories
1.2.1 Ensure GPG keys are configured
CHECK:,Verify GPG keys are configured correctly for your packet manager
gpg-pubkey-8483c65d-5ccc5b19 --> gpg(CentOS (CentOS Official Signing Key) <security@centos.org>)
1.2.2 Ensure gpgcheck is globally activated
Pass:,gpgcheck is configured correctly
1.2.3 Ensure package manager repositories are configured
CHECK:,Verify that repositories are configured correctly
repo id                         repo name
appstream                       CentOS Linux 8 - AppStream
baseos                          CentOS Linux 8 - BaseOS
extras                          CentOS Linux 8 - Extras
1.3.1 Ensure sudo is installed
Pass:,sudo is installed
1.3.2 Ensure sudo commands use pty
Fail:,sudo commands are not configured properly
1.3.3 Ensure sudo log file exists
Fail:,sudo log file does not exist
END OF CHAPTER 1

CHAPTER 2 : SERVICES

2.1 inetd Services

2.1.1 Ensure xinetd is not installed
Pass:,xinetd is not installed

2.2 Time Synchronisation

2.2.1.1 Ensure time synchronisation is in use
Pass:,chrony is installed
2.2.3 Ensure rsyncd server is not enabled
Pass:,rsyncd is not enabled
2.2.4 Ensure avahi-daemon server is not enabled
Fail:,avahi-daemon is enabled
2.2.5 Ensure snmpd server is not enabled
Pass:,snmpd is not enabled
2.2.6 Ensure squid server is not enabled
Pass:,squid is not enabled
2.2.7 Ensure smb server is not enabled
Pass:,smb is not enabled
2.2.8 Ensure dovecot server is not enabled
Pass:,dovecot is not enabled
2.2.9 Ensure httpd server is not enabled
Pass:,httpd is not enabled
2.2.10 Ensure vsftpd server is not enabled
Pass:,vsftpd is not enabled
2.2.11 Ensure named server is not enabled
Pass:,named is not enabled
2.2.12 Ensure nfs server is not enabled
Pass:,nfs is not enabled
2.2.13 Ensure rpcbind server is not enabled
Fail:,rpcbind is enabled
2.2.14 Ensure slapd server is not enabled
Pass:,slapd is not enabled
2.2.15 Ensure dhcpd server is not enabled
Pass:,dhcpd is not enabled
2.2.16 Ensure ypserv server is not enabled
Pass:,ypserv is not enabled
2.2.18 Ensure mail transfer agent is configured for local-only mode
Pass:,MTA is not listening on any non-loopback address(127.0.0.1 or ::1)

2.3 Service Clients

2.3.1 Ensure NIS Client is not installed
Pass:,'ypbind' is not installed
2.3.2 Ensure telnet client is not installed
Fail:,telnet is installed
2.3.3 Ensure LDAP client is not installed
Pass:,'openldap-clients' is not installed
CHAPTER 3: NETWORK CONFIGURATION

3.1 Network Parameters Host Only
3.1.1 Ensure IP forwarding is disabled
Fail:,IP forwarding is not disabled
                
3.1.2 Ensure packet redirect sending is disabled
Fail:,Packet redirect sending is not disabled
                
3.2 Network Parameters Host and Router
3.2.1 Ensure source routed packets are not accepted
Fail:,Source routed packets are accepted
                
3.2.2 Ensure ICMP redirects are not accepted
Fail:,ICMP redirects are accepted
                
3.2.3 Ensure secure ICMP redirects are not accepted
Fail:,Secure ICMP redirects are accepted
                
3.2.4 Ensure suspicious packets are logged
Fail:,Suspicious packets are not logged
                
3.2.5 Ensure broadcast ICMP requests are ignored
Pass:,Broadcast ICMP requests are ignored
                
3.2.6 Ensure bogus ICMP responses are ignored
Pass:,Bogus ICMP responses are ignored
                
3.2.7 Ensure Reverse Path Filtering is enabled
Fail:,Reverse Path Filtering is not enabled
                
3.2.8 Ensure TCP SYN Cookies is enabled
Pass:,TCP SYN Cookies is enabled
                
3.2.9 Ensure IPv6 router advertisements are not accepted
Fail:,IPv6 router advertisements are accepted
                
3.4 Firewall Configuration
3.4.1 Ensure Firewall Software is installed
3.4.1.1 Ensure a Firewall package is installed
Pass:,A firewall package is installed
                
3.4.2 Configure firewalld
3.4.2.1 Ensure firewalld service is enabled and running
Pass:,firewalld service is enabled and running
                
3.4.2.2 Ensure nftables is not enabled
Pass:,nftables is not enabled
                
3.4.2.3 Ensure default zone is set
Pass:,Default zone is set
                
3.4.2.4 Ensure network interfaces are assigned to appropriate zone
incomplete 3.4.2.4
3.4.2.5 Ensure unnecessary services and ports are not accepted
incomplete 3.4.2.5
3.4.2.6 Ensure iptables is not enabled
Fail:,iptables is enabled
                
3.4.3 Configure nftables
3.4.3.1 Ensure iptables are flushed
Pass:,iptables are flushed
                
3.4.3.2 Ensure a table exists
Pass:,A table exists
                
3.4.3.3 Ensure base chains exist
Fail:,base chains do not exists
                
3.4.3.4 Ensure loopback traffic is configured
Fail:,loopback traffic is not configured
                
3.4.3.5 Ensure outbound and established connections are configured
Fail:,outbound and established connections are not configured
                
3.4.3.6 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.3.7 Ensure nftables service is eabled
Fail:,nftables service is not enabled
                
3.4.3.8 Ensure nftables rules are permanent
3.4.3.8 Unsure how to do
3.4.4 Configure iptables
3.4.4.1 Configure IPv4 iptables
3.4.4.1.1 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.4.1.2 Ensure loopback traffic is configured
3.4.4.1.2 Unsure how to do
3.4.4.1.3 Ensure outbound and established connections are configured
3.4.4.1.3 Unsure how to do
3.4.4.1.4 Ensure firewall rule exists for all open ports
3.4.4.1.4 Unsure how to do
3.4.4.2 Configure IPv6 ip6tables
3.4.4.2.1 Ensure IPv6 default deny firewall policy
3.4.4.2.1 Unsure how to do
3.4.4.2.2 Ensure IPv6 loopback traffic is configured
3.4.4.2.2 Unsure how to do
3.4.4.2.3 Ensure IPv6 outbound and established connections are not configured
3.4.4.2.3 Unsure how to do
3.4.4.2.4 Ensure IPv6 firewall rules exist for all open ports
3.4.4.2 Unsure how to do


PART 4 : LOGGING AND AUDITING

4.2 Configure logging

4.2.1 COnfigure rsyslog

4.2.1.1 Ensure rsyslog is installed
Pass:,rsyslog is installed
4.2.1.2 Ensure rsyslog Service is installed
Pass:,rsyslog Service is installed
4.2.1.3 Ensure rsyslog default file permissions configured
Fail:,$FileCreateMode is not 0640 or more restrictive
4.2.1.4 Ensure logging is configured
Pass:,logging is configured (Check /etc/rsyslog.conf and /etc/rsyslog.d/*.conf and edit the lines as appropriate for your environment)
4.2.1.5 Ensure rsyslog is configured to send logs to a remote log host
Fail:,rysyslog is not configured to send logs to a remote log host

4.2.2 Configure Journald

4.2.2.1 Ensure journald is configured to send logs to rsyslog
Fail:,journald does not forward logs to syslog
4.2.2.2 Ensure journald is configured to compress large log files
Pass:,journald is set to compress large files
4.2.2.3 Ensure journald is configured to write logfiles to persistent disk
Fail:,logs are not persisted to disk
4.2.3 Ensure permissions on all logfiles are configured
Fail:,Other has permissions on some files and Group has write or execute permissions on some files


6.1.2 Ensure permissions on /etc/passwd are configured
Pass:,Permisions are set ,(PAGE 421)
6.1.3 Ensure permissions on /etc/shadow are configured
Fail:,Permisions are not set
6.1.4 Ensure permissions on /etc/group are configured
Pass:,Permisions are set ,(PAGE 423)
6.1.5 Ensure permissions on /etc/gshadow are configured
Fail:,Permisions are not set
6.1.6 Ensure permissions on /etc/passwd- are configured
Fail:,Permisions are not set
6.1.7 Ensure permissions on /etc/shadow- are configured
Fail:,Permisions are not set
6.1.8 Ensure permissions on /etc/group- are configured
Fail:,Permisions are not set
6.1.9 Ensure permissions on /etc/gshadow- are configured
Fail:,Permisions are not set
6.1.10 Ensure no world writable files exist
Pass:,No world writable files exist ,(PAGE 430)
6.1.11 Ensure no unowned files or directories exist
Pass:,No unowned files or directories exist ,(PAGE 432)
6.1.12 Ensure no ungrouped files or directories exist
Pass:,No ungrouped files or directories exist ,(PAGE 434)
6.1.13 Audit SUID executables
Output listed:
/usr/bin/vmware-user-suid-wrapper
/usr/bin/mount
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/su
/usr/bin/crontab
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/umount
/usr/bin/at
/usr/bin/fusermount
/usr/lib/polkit-1/polkit-agent-helper-1
/usr/sbin/mount.nfs
/usr/sbin/pam_timestamp_check
/usr/sbin/unix_chkpwd
/usr/sbin/userhelper
/usr/sbin/grub2-set-bootflag
/usr/libexec/dbus-1/dbus-daemon-launch-helper
/usr/libexec/sssd/krb5_child
/usr/libexec/sssd/selinux_child
/usr/libexec/sssd/ldap_child
/usr/libexec/sssd/proxy_child
/usr/libexec/cockpit-session
/usr/libexec/spice-gtk-x86_64/spice-client-glib-usb-acl-helper
/usr/libexec/Xorg.wrap
/usr/libexec/qemu-bridge-helper
6.1.14 Audit SGID executables
Output listed:
/usr/bin/locate
/usr/bin/write
/usr/sbin/lockdev
/usr/libexec/utempter/utempter
/usr/libexec/openssh/ssh-keysign
6.2.1 Ensure password fields are not empty
Pass:,password feilds are not empty ,(PAGE 441)
6.2.2 Ensure no legacy + entries exist in /etc/passwd
Pass:,no legacy + entries exist in /etc/passwd ,(PAGE 442)
6.2.3 Ensure root PATH Integrity
Fail:,Cant ensure root PATH Integrity ,(PAGE 443)
6.2.4 Ensure no legacy + entries exist in /etc/shadow
Pass:,no legacy + entries exist in /etc/shadow ,(PAGE 444)
6.2.5 Ensure no legacy + entries exist in /etc/group
Pass:,no legacy + entries exist in /etc/group ,(PAGE 445)
6.2.6 Ensure root is the only UID 0 account
Pass:,root is the only UID 0 account ,(PAGE 446)
6.2.7 Ensure users home directories permissions are 750 or more restrictive
Pass:,users home directories permissions are 750 or more restrictive
6.2.8 Ensure users own their home directories
Fail:,users do not own their home directories ,(PAGE 449)
6.2.9 Ensure users dot files are not group or world writable
Pass:,users dot files are not group or world writable
6.2.10 Ensure no users have .forward files
Pass:,no users have .forward files
6.2.11 Ensure no users have .netrc files
Pass:,No users have .netrc files
6.2.12 Ensure users .netrc Files are not group or world accessible
Pass:,users .netrc Files are not group or world accessible
6.2.13 Ensure no users have .rhosts files
Pass:,no users have .rhosts files
6.2.14 Ensure all groups in /etc/passwd exist in /etc/group
Pass:,all groups in /etc/passwd exist in /etc/group
6.2.15 Ensure no duplicate UIDs exist
Pass:,no duplicate UIDs exist
6.2.16 Ensure no duplicate GIDs exist
Pass:,no duplicate GIDs exist
6.2.17 Ensure no duplicate user names exist
Pass:,no duplicate user names exist
6.2.18 Ensure no duplicate group names exist
Pass:,no duplicate group names exist
6.2.19 Ensure shadow group is empty
Pass:,shadow group is empty
6.2.20 Ensure all users home directories exist
Pass:,all users home directories exist
NUMBER OF PASSES:,63
NUMBER OF FAILED:,40

-----------------------------
Mon Jun  7 20:34:46 +08 2021
-----------------------------
LEVEL 1 WORKSTATION AUDIT

CHAPTER 1 : INITIAL SETUP

1.1.1.1: Ensure mounting of cramfs filesystems is disabled
Fail:,Cramfs is not disabled
1.1.1.3: Ensure mounting of squashfs filesystems is disabled
Fail:,squashfs filesystems is not disabled
1.1.1.4 Ensure mounting of udf filesystems is disabled
Fail:,udf filesystems are not disabled
1.1.2 Ensure /tmp is configured
Fail:,/tmp is not configured properly
1.1.3 Ensure nodev option set on /tmp partition
Pass:,/tmp is configured properly
1.1.4 Ensure nosuid option set on /tmp partition
Pass:,/tmp is configured properly
\ePass:,/tmp is configured properly\e
1.1.8 Ensure nodev option set on /var/tmp partition
Pass:,/var/tmp is configured properly
1.1.9 Ensure nosuid option set on /var/tmp partition 
\ePass:,/var/tmp is configured properly\e
1.1.10 Ensure noexec option set on /var/tmp partition 
Pass:,/var/tmp is configured properly
1.1.14 Ensure nodev option set on /home partition
Fail:,/home is not configured properly
1.1.15 Ensure nodev option set on /dev/shm partition
Pass:,1.1.15 is configured properly
1.1.16 Ensure nosuid option set on /dev/shm partition
Pass:,/dev/shm is configured properly
1.1.17 Ensure noexec option set on /dev/shm partition
Fail:,/dev/shm is not configured properly
1.1.21 Ensure sticky bit is set on all world-writable directories
Fail:,Sticky bit is not set on all world-writable diectories
1.2.1 Ensure GPG keys are configured
CHECK:,Verify GPG keys are configured correctly for your packet manager
gpg-pubkey-8483c65d-5ccc5b19 --> gpg(CentOS (CentOS Official Signing Key) <security@centos.org>)
1.2.2 Ensure gpgcheck is globally activated
Pass:,gpgcheck is configured correctly
1.2.3 Ensure package manager repositories are configured
CHECK:,Verify that repositories are configured correctly
repo id                         repo name
appstream                       CentOS Linux 8 - AppStream
baseos                          CentOS Linux 8 - BaseOS
extras                          CentOS Linux 8 - Extras
1.3.1 Ensure sudo is installed
Pass:,sudo is installed
1.3.2 Ensure sudo commands use pty
Fail:,sudo commands are not configured properly
1.3.3 Ensure sudo log file exists
Fail:,sudo log file does not exist
END OF CHAPTER 1

CHAPTER 2 : SERVICES

2.1 inetd Services

2.1.1 Ensure xinetd is not installed
Pass:,xinetd is not installed

2.2 Time Synchronisation

2.2.1.1 Ensure time synchronisation is in use
Pass:,chrony is installed
2.2.3 Ensure rsyncd server is not enabled
Pass:,rsyncd is not enabled
2.2.4 Ensure avahi-daemon server is not enabled
Fail:,avahi-daemon is enabled
2.2.5 Ensure snmpd server is not enabled
Pass:,snmpd is not enabled
2.2.6 Ensure squid server is not enabled
Pass:,squid is not enabled
2.2.7 Ensure smb server is not enabled
Pass:,smb is not enabled
2.2.8 Ensure dovecot server is not enabled
Pass:,dovecot is not enabled
2.2.9 Ensure httpd server is not enabled
Pass:,httpd is not enabled
2.2.10 Ensure vsftpd server is not enabled
Pass:,vsftpd is not enabled
2.2.11 Ensure named server is not enabled
Pass:,named is not enabled
2.2.12 Ensure nfs server is not enabled
Pass:,nfs is not enabled
2.2.13 Ensure rpcbind server is not enabled
Fail:,rpcbind is enabled
2.2.14 Ensure slapd server is not enabled
Pass:,slapd is not enabled
2.2.15 Ensure dhcpd server is not enabled
Pass:,dhcpd is not enabled
2.2.16 Ensure ypserv server is not enabled
Pass:,ypserv is not enabled
2.2.18 Ensure mail transfer agent is configured for local-only mode
Pass:,MTA is not listening on any non-loopback address(127.0.0.1 or ::1)

2.3 Service Clients

2.3.1 Ensure NIS Client is not installed
Pass:,'ypbind' is not installed
2.3.2 Ensure telnet client is not installed
Fail:,telnet is installed
2.3.3 Ensure LDAP client is not installed
Pass:,'openldap-clients' is not installed
CHAPTER 3: NETWORK CONFIGURATION

3.1 Network Parameters Host Only
3.1.1 Ensure IP forwarding is disabled
Fail:,IP forwarding is not disabled
                
3.1.2 Ensure packet redirect sending is disabled
Fail:,Packet redirect sending is not disabled
                
3.2 Network Parameters Host and Router
3.2.1 Ensure source routed packets are not accepted
Fail:,Source routed packets are accepted
                
3.2.2 Ensure ICMP redirects are not accepted
Fail:,ICMP redirects are accepted
                
3.2.3 Ensure secure ICMP redirects are not accepted
Fail:,Secure ICMP redirects are accepted
                
3.2.4 Ensure suspicious packets are logged
Fail:,Suspicious packets are not logged
                
3.2.5 Ensure broadcast ICMP requests are ignored
Pass:,Broadcast ICMP requests are ignored
                
3.2.6 Ensure bogus ICMP responses are ignored
Pass:,Bogus ICMP responses are ignored
                
3.2.7 Ensure Reverse Path Filtering is enabled
Fail:,Reverse Path Filtering is not enabled
                
3.2.8 Ensure TCP SYN Cookies is enabled
Pass:,TCP SYN Cookies is enabled
                
3.2.9 Ensure IPv6 router advertisements are not accepted
Fail:,IPv6 router advertisements are accepted
                
3.4 Firewall Configuration
3.4.1 Ensure Firewall Software is installed
3.4.1.1 Ensure a Firewall package is installed
Pass:,A firewall package is installed
                
3.4.2 Configure firewalld
3.4.2.1 Ensure firewalld service is enabled and running
Pass:,firewalld service is enabled and running
                
3.4.2.2 Ensure nftables is not enabled
Pass:,nftables is not enabled
                
3.4.2.3 Ensure default zone is set
Pass:,Default zone is set
                
3.4.2.4 Ensure network interfaces are assigned to appropriate zone
incomplete 3.4.2.4
3.4.2.5 Ensure unnecessary services and ports are not accepted
incomplete 3.4.2.5
3.4.2.6 Ensure iptables is not enabled
Fail:,iptables is enabled
                
3.4.3 Configure nftables
3.4.3.1 Ensure iptables are flushed
Pass:,iptables are flushed
                
3.4.3.2 Ensure a table exists
Pass:,A table exists
                
3.4.3.3 Ensure base chains exist
Fail:,base chains do not exists
                
3.4.3.4 Ensure loopback traffic is configured
Fail:,loopback traffic is not configured
                
3.4.3.5 Ensure outbound and established connections are configured
Fail:,outbound and established connections are not configured
                
3.4.3.6 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.3.7 Ensure nftables service is eabled
Fail:,nftables service is not enabled
                
3.4.3.8 Ensure nftables rules are permanent
3.4.3.8 Unsure how to do
3.4.4 Configure iptables
3.4.4.1 Configure IPv4 iptables
3.4.4.1.1 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.4.1.2 Ensure loopback traffic is configured
3.4.4.1.2 Unsure how to do
3.4.4.1.3 Ensure outbound and established connections are configured
3.4.4.1.3 Unsure how to do
3.4.4.1.4 Ensure firewall rule exists for all open ports
3.4.4.1.4 Unsure how to do
3.4.4.2 Configure IPv6 ip6tables
3.4.4.2.1 Ensure IPv6 default deny firewall policy
3.4.4.2.1 Unsure how to do
3.4.4.2.2 Ensure IPv6 loopback traffic is configured
3.4.4.2.2 Unsure how to do
3.4.4.2.3 Ensure IPv6 outbound and established connections are not configured
3.4.4.2.3 Unsure how to do
3.4.4.2.4 Ensure IPv6 firewall rules exist for all open ports
3.4.4.2 Unsure how to do


PART 4 : LOGGING AND AUDITING

4.2 Configure logging

4.2.1 COnfigure rsyslog

4.2.1.1 Ensure rsyslog is installed
Pass:,rsyslog is installed
4.2.1.2 Ensure rsyslog Service is installed
Pass:,rsyslog Service is installed
4.2.1.3 Ensure rsyslog default file permissions configured
Fail:,$FileCreateMode is not 0640 or more restrictive
4.2.1.4 Ensure logging is configured
Pass:,logging is configured (Check /etc/rsyslog.conf and /etc/rsyslog.d/*.conf and edit the lines as appropriate for your environment)
4.2.1.5 Ensure rsyslog is configured to send logs to a remote log host
Fail:,rysyslog is not configured to send logs to a remote log host

4.2.2 Configure Journald

4.2.2.1 Ensure journald is configured to send logs to rsyslog
Fail:,journald does not forward logs to syslog
4.2.2.2 Ensure journald is configured to compress large log files
Pass:,journald is set to compress large files
4.2.2.3 Ensure journald is configured to write logfiles to persistent disk
Fail:,logs are not persisted to disk
4.2.3 Ensure permissions on all logfiles are configured
Fail:,Other has permissions on some files and Group has write or execute permissions on some files


6.1.2 Ensure permissions on /etc/passwd are configured
Pass:,Permisions are set ,(PAGE 421)
6.1.3 Ensure permissions on /etc/shadow are configured
Fail:,Permisions are not set
6.1.4 Ensure permissions on /etc/group are configured
Pass:,Permisions are set ,(PAGE 423)
6.1.5 Ensure permissions on /etc/gshadow are configured
Fail:,Permisions are not set
6.1.6 Ensure permissions on /etc/passwd- are configured
Fail:,Permisions are not set
6.1.7 Ensure permissions on /etc/shadow- are configured
Fail:,Permisions are not set
6.1.8 Ensure permissions on /etc/group- are configured
Fail:,Permisions are not set
6.1.9 Ensure permissions on /etc/gshadow- are configured
Fail:,Permisions are not set
6.1.10 Ensure no world writable files exist
Pass:,No world writable files exist ,(PAGE 430)
6.1.11 Ensure no unowned files or directories exist
Pass:,No unowned files or directories exist ,(PAGE 432)
6.1.12 Ensure no ungrouped files or directories exist
Pass:,No ungrouped files or directories exist ,(PAGE 434)
6.1.13 Audit SUID executables
Output listed:
/usr/bin/vmware-user-suid-wrapper
/usr/bin/mount
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/su
/usr/bin/crontab
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/umount
/usr/bin/at
/usr/bin/fusermount
/usr/lib/polkit-1/polkit-agent-helper-1
/usr/sbin/mount.nfs
/usr/sbin/pam_timestamp_check
/usr/sbin/unix_chkpwd
/usr/sbin/userhelper
/usr/sbin/grub2-set-bootflag
/usr/libexec/dbus-1/dbus-daemon-launch-helper
/usr/libexec/sssd/krb5_child
/usr/libexec/sssd/selinux_child
/usr/libexec/sssd/ldap_child
/usr/libexec/sssd/proxy_child
/usr/libexec/cockpit-session
/usr/libexec/spice-gtk-x86_64/spice-client-glib-usb-acl-helper
/usr/libexec/Xorg.wrap
/usr/libexec/qemu-bridge-helper
6.1.14 Audit SGID executables
Output listed:
/usr/bin/locate
/usr/bin/write
/usr/sbin/lockdev
/usr/libexec/utempter/utempter
/usr/libexec/openssh/ssh-keysign
6.2.1 Ensure password fields are not empty
Pass:,password feilds are not empty ,(PAGE 441)
6.2.2 Ensure no legacy + entries exist in /etc/passwd
Pass:,no legacy + entries exist in /etc/passwd ,(PAGE 442)
6.2.3 Ensure root PATH Integrity
Fail:,Cant ensure root PATH Integrity ,(PAGE 443)
6.2.4 Ensure no legacy + entries exist in /etc/shadow
Pass:,no legacy + entries exist in /etc/shadow ,(PAGE 444)
6.2.5 Ensure no legacy + entries exist in /etc/group
Pass:,no legacy + entries exist in /etc/group ,(PAGE 445)
6.2.6 Ensure root is the only UID 0 account
Pass:,root is the only UID 0 account ,(PAGE 446)
6.2.7 Ensure users home directories permissions are 750 or more restrictive
Pass:,users home directories permissions are 750 or more restrictive
6.2.8 Ensure users own their home directories
Fail:,users do not own their home directories ,(PAGE 449)
6.2.9 Ensure users dot files are not group or world writable
Pass:,users dot files are not group or world writable
6.2.10 Ensure no users have .forward files
Pass:,no users have .forward files
6.2.11 Ensure no users have .netrc files
Pass:,No users have .netrc files
6.2.12 Ensure users .netrc Files are not group or world accessible
Pass:,users .netrc Files are not group or world accessible
6.2.13 Ensure no users have .rhosts files
Pass:,no users have .rhosts files
6.2.14 Ensure all groups in /etc/passwd exist in /etc/group
Pass:,all groups in /etc/passwd exist in /etc/group
6.2.15 Ensure no duplicate UIDs exist
Pass:,no duplicate UIDs exist
6.2.16 Ensure no duplicate GIDs exist
Pass:,no duplicate GIDs exist
6.2.17 Ensure no duplicate user names exist
Pass:,no duplicate user names exist
6.2.18 Ensure no duplicate group names exist
Pass:,no duplicate group names exist
6.2.19 Ensure shadow group is empty
Pass:,shadow group is empty
6.2.20 Ensure all users home directories exist
Pass:,all users home directories exist
NUMBER OF PASSES:,63
NUMBER OF FAILED:,40

-----------------------------
Mon Jun  7 20:36:52 +08 2021
-----------------------------
LEVEL 1 WORKSTATION AUDIT

CHAPTER 1 : INITIAL SETUP

1.1.1.1: Ensure mounting of cramfs filesystems is disabled
Fail:,Cramfs is not disabled
1.1.1.3: Ensure mounting of squashfs filesystems is disabled
Fail:,squashfs filesystems is not disabled
1.1.1.4 Ensure mounting of udf filesystems is disabled
Fail:,udf filesystems are not disabled
1.1.2 Ensure /tmp is configured
Fail:,/tmp is not configured properly
1.1.3 Ensure nodev option set on /tmp partition
Pass:,/tmp is configured properly
1.1.4 Ensure nosuid option set on /tmp partition
Pass:,/tmp is configured properly
1.1.5 Ensure noexec option set on /tmp partition 
\ePass:,/tmp is configured properly\e
1.1.8 Ensure nodev option set on /var/tmp partition
Pass:,/var/tmp is configured properly
1.1.9 Ensure nosuid option set on /var/tmp partition 
\ePass:,/var/tmp is configured properly\e
1.1.10 Ensure noexec option set on /var/tmp partition 
Pass:,/var/tmp is configured properly
1.1.14 Ensure nodev option set on /home partition
Fail:,/home is not configured properly
1.1.15 Ensure nodev option set on /dev/shm partition
Pass:,1.1.15 is configured properly
1.1.16 Ensure nosuid option set on /dev/shm partition
Pass:,/dev/shm is configured properly
1.1.17 Ensure noexec option set on /dev/shm partition
Fail:,/dev/shm is not configured properly
1.1.21 Ensure sticky bit is set on all world-writable directories
Fail:,Sticky bit is not set on all world-writable diectories
1.2.1 Ensure GPG keys are configured
CHECK:,Verify GPG keys are configured correctly for your packet manager
gpg-pubkey-8483c65d-5ccc5b19 --> gpg(CentOS (CentOS Official Signing Key) <security@centos.org>)
1.2.2 Ensure gpgcheck is globally activated
Pass:,gpgcheck is configured correctly
1.2.3 Ensure package manager repositories are configured
CHECK:,Verify that repositories are configured correctly
repo id                         repo name
appstream                       CentOS Linux 8 - AppStream
baseos                          CentOS Linux 8 - BaseOS
extras                          CentOS Linux 8 - Extras
1.3.1 Ensure sudo is installed
Pass:,sudo is installed
1.3.2 Ensure sudo commands use pty
Fail:,sudo commands are not configured properly
1.3.3 Ensure sudo log file exists
Fail:,sudo log file does not exist
END OF CHAPTER 1

CHAPTER 2 : SERVICES

2.1 inetd Services

2.1.1 Ensure xinetd is not installed
Pass:,xinetd is not installed

2.2 Time Synchronisation

2.2.1.1 Ensure time synchronisation is in use
Pass:,chrony is installed
2.2.3 Ensure rsyncd server is not enabled
Pass:,rsyncd is not enabled
2.2.4 Ensure avahi-daemon server is not enabled
Fail:,avahi-daemon is enabled
2.2.5 Ensure snmpd server is not enabled
Pass:,snmpd is not enabled
2.2.6 Ensure squid server is not enabled
Pass:,squid is not enabled
2.2.7 Ensure smb server is not enabled
Pass:,smb is not enabled
2.2.8 Ensure dovecot server is not enabled
Pass:,dovecot is not enabled
2.2.9 Ensure httpd server is not enabled
Pass:,httpd is not enabled
2.2.10 Ensure vsftpd server is not enabled
Pass:,vsftpd is not enabled
2.2.11 Ensure named server is not enabled
Pass:,named is not enabled
2.2.12 Ensure nfs server is not enabled
Pass:,nfs is not enabled
2.2.13 Ensure rpcbind server is not enabled
Fail:,rpcbind is enabled
2.2.14 Ensure slapd server is not enabled
Pass:,slapd is not enabled
2.2.15 Ensure dhcpd server is not enabled
Pass:,dhcpd is not enabled
2.2.16 Ensure ypserv server is not enabled
Pass:,ypserv is not enabled
2.2.18 Ensure mail transfer agent is configured for local-only mode
Pass:,MTA is not listening on any non-loopback address(127.0.0.1 or ::1)

2.3 Service Clients

2.3.1 Ensure NIS Client is not installed
Pass:,'ypbind' is not installed
2.3.2 Ensure telnet client is not installed
Fail:,telnet is installed
2.3.3 Ensure LDAP client is not installed
Pass:,'openldap-clients' is not installed
CHAPTER 3: NETWORK CONFIGURATION

3.1 Network Parameters Host Only
3.1.1 Ensure IP forwarding is disabled
Fail:,IP forwarding is not disabled
                
3.1.2 Ensure packet redirect sending is disabled
Fail:,Packet redirect sending is not disabled
                
3.2 Network Parameters Host and Router
3.2.1 Ensure source routed packets are not accepted
Fail:,Source routed packets are accepted
                
3.2.2 Ensure ICMP redirects are not accepted
Fail:,ICMP redirects are accepted
                
3.2.3 Ensure secure ICMP redirects are not accepted
Fail:,Secure ICMP redirects are accepted
                
3.2.4 Ensure suspicious packets are logged
Fail:,Suspicious packets are not logged
                
3.2.5 Ensure broadcast ICMP requests are ignored
Pass:,Broadcast ICMP requests are ignored
                
3.2.6 Ensure bogus ICMP responses are ignored
Pass:,Bogus ICMP responses are ignored
                
3.2.7 Ensure Reverse Path Filtering is enabled
Fail:,Reverse Path Filtering is not enabled
                
3.2.8 Ensure TCP SYN Cookies is enabled
Pass:,TCP SYN Cookies is enabled
                
3.2.9 Ensure IPv6 router advertisements are not accepted
Fail:,IPv6 router advertisements are accepted
                
3.4 Firewall Configuration
3.4.1 Ensure Firewall Software is installed
3.4.1.1 Ensure a Firewall package is installed
Pass:,A firewall package is installed
                
3.4.2 Configure firewalld
3.4.2.1 Ensure firewalld service is enabled and running
Pass:,firewalld service is enabled and running
                
3.4.2.2 Ensure nftables is not enabled
Pass:,nftables is not enabled
                
3.4.2.3 Ensure default zone is set
Pass:,Default zone is set
                
3.4.2.4 Ensure network interfaces are assigned to appropriate zone
incomplete 3.4.2.4
3.4.2.5 Ensure unnecessary services and ports are not accepted
incomplete 3.4.2.5
3.4.2.6 Ensure iptables is not enabled
Fail:,iptables is enabled
                
3.4.3 Configure nftables
3.4.3.1 Ensure iptables are flushed
Pass:,iptables are flushed
                
3.4.3.2 Ensure a table exists
Pass:,A table exists
                
3.4.3.3 Ensure base chains exist
Fail:,base chains do not exists
                
3.4.3.4 Ensure loopback traffic is configured
Fail:,loopback traffic is not configured
                
3.4.3.5 Ensure outbound and established connections are configured
Fail:,outbound and established connections are not configured
                
3.4.3.6 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.3.7 Ensure nftables service is eabled
Fail:,nftables service is not enabled
                
3.4.3.8 Ensure nftables rules are permanent
3.4.3.8 Unsure how to do
3.4.4 Configure iptables
3.4.4.1 Configure IPv4 iptables
3.4.4.1.1 Ensure default deny firewall policy
Fail:,default firewall policy is not deny
                
3.4.4.1.2 Ensure loopback traffic is configured
3.4.4.1.2 Unsure how to do
3.4.4.1.3 Ensure outbound and established connections are configured
3.4.4.1.3 Unsure how to do
3.4.4.1.4 Ensure firewall rule exists for all open ports
3.4.4.1.4 Unsure how to do
3.4.4.2 Configure IPv6 ip6tables
3.4.4.2.1 Ensure IPv6 default deny firewall policy
3.4.4.2.1 Unsure how to do
3.4.4.2.2 Ensure IPv6 loopback traffic is configured
3.4.4.2.2 Unsure how to do
3.4.4.2.3 Ensure IPv6 outbound and established connections are not configured
3.4.4.2.3 Unsure how to do
3.4.4.2.4 Ensure IPv6 firewall rules exist for all open ports
3.4.4.2 Unsure how to do


PART 4 : LOGGING AND AUDITING

4.2 Configure logging

4.2.1 COnfigure rsyslog

4.2.1.1 Ensure rsyslog is installed
Pass:,rsyslog is installed
4.2.1.2 Ensure rsyslog Service is installed
Pass:,rsyslog Service is installed
4.2.1.3 Ensure rsyslog default file permissions configured
Fail:,$FileCreateMode is not 0640 or more restrictive
4.2.1.4 Ensure logging is configured
Pass:,logging is configured (Check /etc/rsyslog.conf and /etc/rsyslog.d/*.conf and edit the lines as appropriate for your environment)
4.2.1.5 Ensure rsyslog is configured to send logs to a remote log host
Fail:,rysyslog is not configured to send logs to a remote log host

4.2.2 Configure Journald

4.2.2.1 Ensure journald is configured to send logs to rsyslog
Fail:,journald does not forward logs to syslog
4.2.2.2 Ensure journald is configured to compress large log files
Pass:,journald is set to compress large files
4.2.2.3 Ensure journald is configured to write logfiles to persistent disk
Fail:,logs are not persisted to disk
4.2.3 Ensure permissions on all logfiles are configured
Fail:,Other has permissions on some files and Group has write or execute permissions on some files


6.1.2 Ensure permissions on /etc/passwd are configured
Pass:,Permisions are set ,(PAGE 421)
6.1.3 Ensure permissions on /etc/shadow are configured
Fail:,Permisions are not set
6.1.4 Ensure permissions on /etc/group are configured
Pass:,Permisions are set ,(PAGE 423)
6.1.5 Ensure permissions on /etc/gshadow are configured
Fail:,Permisions are not set
6.1.6 Ensure permissions on /etc/passwd- are configured
Fail:,Permisions are not set
6.1.7 Ensure permissions on /etc/shadow- are configured
Fail:,Permisions are not set
6.1.8 Ensure permissions on /etc/group- are configured
Fail:,Permisions are not set
6.1.9 Ensure permissions on /etc/gshadow- are configured
Fail:,Permisions are not set
6.1.10 Ensure no world writable files exist
Pass:,No world writable files exist ,(PAGE 430)
6.1.11 Ensure no unowned files or directories exist
Pass:,No unowned files or directories exist ,(PAGE 432)
6.1.12 Ensure no ungrouped files or directories exist
Pass:,No ungrouped files or directories exist ,(PAGE 434)
6.1.13 Audit SUID executables
Output listed:
/usr/bin/vmware-user-suid-wrapper
/usr/bin/mount
/usr/bin/pkexec
/usr/bin/chfn
/usr/bin/su
/usr/bin/crontab
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/umount
/usr/bin/at
/usr/bin/fusermount
/usr/lib/polkit-1/polkit-agent-helper-1
/usr/sbin/mount.nfs
/usr/sbin/pam_timestamp_check
/usr/sbin/unix_chkpwd
/usr/sbin/userhelper
/usr/sbin/grub2-set-bootflag
/usr/libexec/dbus-1/dbus-daemon-launch-helper
/usr/libexec/sssd/krb5_child
/usr/libexec/sssd/selinux_child
/usr/libexec/sssd/ldap_child
/usr/libexec/sssd/proxy_child
/usr/libexec/cockpit-session
/usr/libexec/spice-gtk-x86_64/spice-client-glib-usb-acl-helper
/usr/libexec/Xorg.wrap
/usr/libexec/qemu-bridge-helper
6.1.14 Audit SGID executables
Output listed:
/usr/bin/locate
/usr/bin/write
/usr/sbin/lockdev
/usr/libexec/utempter/utempter
/usr/libexec/openssh/ssh-keysign
6.2.1 Ensure password fields are not empty
Pass:,password feilds are not empty ,(PAGE 441)
6.2.2 Ensure no legacy + entries exist in /etc/passwd
Pass:,no legacy + entries exist in /etc/passwd ,(PAGE 442)
6.2.3 Ensure root PATH Integrity
Fail:,Cant ensure root PATH Integrity ,(PAGE 443)
6.2.4 Ensure no legacy + entries exist in /etc/shadow
Pass:,no legacy + entries exist in /etc/shadow ,(PAGE 444)
6.2.5 Ensure no legacy + entries exist in /etc/group
Pass:,no legacy + entries exist in /etc/group ,(PAGE 445)
6.2.6 Ensure root is the only UID 0 account
Pass:,root is the only UID 0 account ,(PAGE 446)
6.2.7 Ensure users home directories permissions are 750 or more restrictive
Pass:,users home directories permissions are 750 or more restrictive
6.2.8 Ensure users own their home directories
Fail:,users do not own their home directories ,(PAGE 449)
6.2.9 Ensure users dot files are not group or world writable
Pass:,users dot files are not group or world writable
6.2.10 Ensure no users have .forward files
Pass:,no users have .forward files
6.2.11 Ensure no users have .netrc files
Pass:,No users have .netrc files
6.2.12 Ensure users .netrc Files are not group or world accessible
Pass:,users .netrc Files are not group or world accessible
6.2.13 Ensure no users have .rhosts files
Pass:,no users have .rhosts files
6.2.14 Ensure all groups in /etc/passwd exist in /etc/group
Pass:,all groups in /etc/passwd exist in /etc/group
6.2.15 Ensure no duplicate UIDs exist
Pass:,no duplicate UIDs exist
6.2.16 Ensure no duplicate GIDs exist
Pass:,no duplicate GIDs exist
6.2.17 Ensure no duplicate user names exist
Pass:,no duplicate user names exist
6.2.18 Ensure no duplicate group names exist
Pass:,no duplicate group names exist
6.2.19 Ensure shadow group is empty
Pass:,shadow group is empty
6.2.20 Ensure all users home directories exist
Pass:,all users home directories exist
NUMBER OF PASSES:,63
NUMBER OF FAILED:,40

-----------------------------
Mon Jun  7 21:00:34 +08 2021
-----------------------------
LEVEL 2 WORKSTATION AUDIT

CHAPTER 1 : INITAL SETUP

1.1.1.2: Ensure mounting of vFAT filesystems is limited
Fail:,vFAT is not configured properly
1.1.6 Ensure separate partition exists for /var 
Pass:,/var is configured properly
1.1.7 Ensure separate partition exists for /var/tmp
Fail:,Seperation partition does not exist
1.1.11 Ensure separate partition exists for /var/log 
Fail:,Seperate partion does not exist for /var/log
1.1.12 Ensure separate partition exists for /var/log/audit 
Fail:,Seperate partition does not exist for /var/log/audit
1.1.13 Ensure separate partition exists for /home 
Pass:,/home is configured properly
1.1.22 Disable Automounting 
Pass:,Automounting is configured properly
1.1.23 Disable USB Storage 
Fail:,USB Storage is not disabled
END OF CHAPTER 1

CHAPTER 2 : SERVICES

2.2.16 Ensure CUPS is not enabled
Fail:,cups is enabled

CHAPTER 3: NETWORK CONFIGURATION

3.3 Uncommon Network Protocols
3.3.1 Ensure DCCP is disabled
Fail:,DCCP is not disabled
                
3.3.2 Ensure SCTP is disabled
Fail:,SCTP is not disabled
                
3.3.3 Ensure RDS is disabled
Fail:,RDS is not disabled
                
3.3.4 Ensure TIPC is disabled
Fail:,TIPC is not disabled
                
3.5 Ensure wireless interfaces are disabled
3.5 Unsure how to do
3.6 Disable IPv6
Fail:,IPv6 is not disabled
                
CHAPTER 4 : LOGGING AND AUDITING


4.1.1 Ensure auditing is enabled
4.1.1.1 Ensure auditd is installed
Pass:,auditd is installed
4.1.1.2 Ensure auditd service is enabled
Pass:,auditd service is enabled
4.1.1.3 Ensure auditing for processees that start prior to auditd is enabled
Pass:,auditing for processes that start prior to auditd is enabled
4.1.1.4 Ensure audit_backlog_limit is sufficient
Pass:,audit_backlog_limit is sufficient

4.1.2 Configure Data Retention
4.1.2.1 Ensure aduit log storage size is configured
Important check:,Check if max_log_file parameter in /etc/audit/auditd.conf in accordance with site policy
4.1.2.2 Ensure audit logs are not automatically deleted
Fail:,Audit logs are automatically deleted
4.1.2.3 Ensure system is disabled when audit logs are full
Fail:,System is not disabled when audit logs are full
4.1.3 Ensure changes to system administration scope(sudoers) is collected
Fail:,Changes to sudoers are not collected
4.1.4 Ensure login and logout events are collected
Fail:,Login and logout events are not collected
4.1.5 Ensure session initiation information is collected
Fail:,Session initiation information is not collected
4.1.6 Ensure events that modify date and time iformation are collected
Fail:,Events that modify data dn time information are not collected
4.1.7 Ensure events that modify Mandatory Access Controls are collected
Pass:,Events that modify system Mandatory Access Controls are collected
4.1.8 Ensure events that modify the system network environment are collected
Fail:,Events that modify the system network environment are not collected
4.1.9 Ensure discretionary access control permission modification events are collected
Fail:,Permission modification events are not collected
4.1.10 Ensure unsuccessful unauthorized file access attempts are collected
Fail:,unsuccessful unauthorised file access attempts are not collected
4.1.11 Ensure events that modify user/group information are collected
Fail:,events that modify user/group info are not collected
4.1.12 Ensure successful file system mounts are collected
Fail:,successful file system mouns are not collected
4.1.14 Ensure file detection events by users are collected
Fail:,File deletion events by users are not collected
4.1.15 Ensure kernel module loading and unloading is collected
Fail:,insmod, rmmod and modprobe are not set
4.1.17 Ensure the audit configuration is immutable
Pass:,Audit configuration is immutable

6.1.1 Audit system permissions
Fail:,bash-4.1.2-29.el6.x86_64 is installed 
NUMBER OF PASSES: 9
NUMBER OF FAILED: 25

-----------------------------
Mon Jun  7 21:02:36 +08 2021
-----------------------------
LEVEL 2 SERVER AUDIT

CHAPTER 1 : INITIAL SETUP

1.1.1.2: Ensure mounting of vFAT filesystems is limited
Fail:,vFAT is not configured properly
1.1.6 Ensure separate partition exists for /var 
Pass:,/var is configured properly
1.1.7 Ensure separate partition exists for /var/tmp
Fail:,Seperation partition does not exist
1.1.11 Ensure separate partition exists for /var/log 
Fail:,Seperate partion does not exist for /var/log
1.1.12 Ensure separate partition exists for /var/log/audit 
Fail:,Seperate partition does not exist for /var/log/audit
1.1.13 Ensure separate partition exists for /home 
Pass:,/home is configured properly
END OF CHAPTER 1

CHAPTER 1 : NETWORK CONFIGURATION

3.3 Uncommon Network Protocols
3.3.1 Ensure DCCP is disabled
Fail:,DCCP is not disabled
                
3.3.2 Ensure SCTP is disabled
Fail:,SCTP is not disabled
                
3.3.3 Ensure RDS is disabled
Fail:,RDS is not disabled
                
3.3.4 Ensure TIPC is disabled
Fail:,TIPC is not disabled
                
3.6 Disable IPv6
Fail:,IPv6 is not disabled
                

CHAPTER 4 LOGGING AND AUDITING

4.1.1 Ensure auditing is enabled
4.1.1.1 Ensure auditd is installed
Pass:,auditd is installed
4.1.1.2 Ensure auditd service is enabled
Fail:,auditd service is not enabled
4.1.1.3 Ensure auditing for processees that start prior to auditd is enabled
Pass:,auditing for processes that start prior to auditd is enabled
4.1.1.4 Ensure audit_backlog_limit is sufficient
Pass:,audit_backlog_limit is sufficient

4.1.2 Configure Data Retention
4.1.2.1 Ensure aduit log storage size is configured
Important check:,Check if max_log_file parameter in /etc/audit/auditd.conf in accordance with site policy
4.1.2.2 Ensure audit logs are not automatically deleted
Fail:,Audit logs are automatically deleted
4.1.2.3 Ensure system is disabled when audit logs are full
Fail:,System is not disabled when audit logs are full
4.1.3 Ensure changes to system administration scope(sudoers) is collected
Fail:,Changes to sudoers are not collected
4.1.4 Ensure login and logout events are collected
Fail:,Login and logout events are not collected
4.1.5 Ensure session initiation information is collected
Fail:,Session initiation information is not collected
4.1.6 Ensure events that modify date and time iformation are collected
Fail:,Events that modify data dn time information are not collected
4.1.7 Ensure events that modify Mandatory Access Controls are collected
Pass:,Events that modify system Mandatory Access Controls are collected
4.1.8 Ensure events that modify the system network environment are collected
Fail:,Events that modify the system network environment are not collected
4.1.9 Ensure discretionary access control permission modification events are collected
Fail:,Permission modification events are not collected
4.1.10 Ensure unsuccessful unauthorized file access attempts are collected
Fail:,unsuccessful unauthorised file access attempts are not collected
4.1.11 Ensure events that modify user/group information are collected
Fail:,events that modify user/group info are not collected
4.1.12 Ensure successful file system mounts are collected
Fail:,successful file system mouns are not collected
4.1.14 Ensure file detection events by users are collected
Fail:,File deletion events by users are not collected
4.1.15 Ensure kernel module loading and unloading is collected
Fail:,insmod, rmmod and modprobe are not set
4.1.17 Ensure the audit configuration is immutable
Pass:,Audit configuration is immutable
6.1.1 Audit system permissions
Fail:,bash-4.1.2-29.el6.x86_64 is installed 

NUMBER OF PASSES: 7
NUMBER OF FAILED: 24
